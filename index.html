<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Live Match & Chat</title>
<style>
body { margin:0; padding:0; font-family: Arial,sans-serif; background:#f0f2f5; display:flex; flex-direction:column; align-items:center; }
.container { width:95%; max-width:600px; margin-top:20px; display:flex; flex-direction:column; gap:12px; }
/* SCOREBOARD */
.scoreboard { background:#fff; border-radius:12px; padding:15px; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
.match-status { text-align:center; font-size:14px; color:#007bff; font-weight:bold; margin-bottom:10px; }
.match-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
.team { display:flex; flex-direction:column; align-items:center; width:90px; cursor:pointer; position:relative; }
.team-logo { width:50px; height:50px; object-fit:contain; border-radius:50%; margin-bottom:4px; transition: transform 0.3s; }
.team-name { font-weight:bold; font-size:14px; text-align:center; }
.score { font-size:36px; font-weight:bold; text-align:center; width:100px; }
.center-line { position:relative; height:2px; background:#e0e0e0; margin:12px 0; }
.center-line::before { content:"⚽"; position:absolute; top:-10px; left:50%; transform:translateX(-50%); background:#fff; padding:0 6px; border-radius:50%; }
.goal-scorers { display:flex; justify-content:space-between; font-size:12px; color:#555; margin-bottom:5px;}
.goal-scorers div { width:90px; text-align:center; }
/* HEXAGON EFFECT */
.hexagon { position:absolute; top:-10px; left:50%; transform:translateX(-50%) scale(0); width:60px; height:60px; background:rgba(0,123,255,0.2); clip-path: polygon(25% 6%,75% 6%,100% 50%,75% 94%,25% 94%,0 50%); animation:hexPop 0.5s forwards; z-index:-1; }
@keyframes hexPop { to { transform:translateX(-50%) scale(1); } }
/* FULL MATCH DETAILS BUTTON */
#fullDetailsBtn { padding:8px; border:none; border-radius:8px; background:#007bff; color:#fff; font-weight:bold; cursor:pointer; width:100%; }
/* TIMELINE */
#timeline { background:#fff; max-height:100px; overflow-y:auto; padding:6px; border-radius:8px; border:1px solid #ddd; font-size:12px; }
/* CHAT */
.chat-container { background:#fff; border-radius:12px; height:300px; padding:10px; overflow-y:auto; display:flex; flex-direction:column; gap:6px; }
.message { max-width:70%; padding:8px 12px; border-radius:20px; word-wrap:break-word; cursor:pointer; }
.message.right { background:#007bff; color:#fff; align-self:flex-end; }
.message.left { background:#e0e0e0; align-self:flex-start; }
/* INPUT */
.input-container { display:flex; gap:6px; margin-top:6px; align-items:center; }
#chatInput { flex:1; border-radius:25px; padding:10px 15px; border:1px solid #ccc; outline:none; font-size:16px; }
#sendBtn { border:none; background:#007bff; border-radius:8px; padding:10px 15px; color:#fff; font-weight:bold; cursor:pointer; }
/* ADMIN */
#adminBtn { position:fixed; bottom:80px; right:20px; padding:12px; border-radius:50%; background:black; color:white; cursor:pointer; z-index:100; }
#adminPanel { display:none; max-height:50vh; overflow-y:auto; background:#fff; border-top:2px solid #000; padding:12px; position:relative; z-index:50; }
.winner-glow { background:rgba(0,0,0,0.05); border-radius:14px; animation:pop 0.5s ease; }
@keyframes pop { from{transform:scale(0.9);} to{transform:scale(1);} }
</style>
</head>
<body>

<div class="container">

  <!-- SCOREBOARD -->
  <div class="scoreboard">
    <div class="match-status" id="matchStatus">Pre-Match</div>
    <div class="match-header">
      <div class="team" id="homeBox">
        <img class="team-logo" id="team1Logo" src="" alt="Home">
        <div class="team-name" id="team1Name">Home</div>
        <div class="hexagon" id="homeHex"></div>
      </div>
      <div class="score" id="scoreBoard">0 : 0</div>
      <div class="team" id="awayBox">
        <img class="team-logo" id="team2Logo" src="" alt="Away">
        <div class="team-name" id="team2Name">Away</div>
        <div class="hexagon" id="awayHex"></div>
      </div>
    </div>
    <div class="center-line"></div>
    <div class="goal-scorers">
      <div id="team1Scorers"></div>
      <div id="team2Scorers"></div>
    </div>
  </div>

  <!-- Full match details -->
  <button id="fullDetailsBtn">FULL MATCH DETAILS</button>

  <!-- Timeline -->
  <div id="timeline"></div>

  <!-- Chat -->
  <div class="chat-container" id="chatBox"></div>
  <div class="input-container">
    <input type="text" id="chatInput" placeholder="Type a message...">
    <button id="sendBtn">SEND</button>
  </div>

</div>

<!-- Admin button & panel -->
<div id="adminBtn">ADMIN</div>
<div id="adminPanel">
  <h3>Admin Panel</h3>
  <input id="homeTeamName" placeholder="Home team name"><br>
  <input id="homeTeamLogo" placeholder="Home logo URL"><br><br>
  <input id="awayTeamName" placeholder="Away team name"><br>
  <input id="awayTeamLogo" placeholder="Away logo URL"><br><br>
  <button onclick="setTeams()">Set Teams</button>
  <hr>
  <select id="stage">
    <option value="pre">Pre-match</option>
    <option value="first">First Half</option>
    <option value="half">Half Time</option>
    <option value="second">Second Half</option>
    <option value="full">Full Time</option>
  </select>
  <button onclick="updateStage()">Update Stage</button>
  <hr>
  <button onclick="addGoal('home')">Home Goal</button>
  <button onclick="addGoal('away')">Away Goal</button>
  <hr>
  <button onclick="resetMatch()">RESET MATCH</button>
  <button onclick="resetChat()">RESET CHAT</button>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script>
firebase.initializeApp({
  apiKey: "AIzaSyA2AScPQkOE632znM9vvCahijtnronS3jU",
  authDomain: "fresherscuplive.firebaseapp.com",
  databaseURL: "https://fresherscuplive-default-rtdb.firebaseio.com",
  projectId: "fresherscuplive",
  storageBucket: "fresherscuplive.firebasestorage.app",
  messagingSenderId: "502451588704",
  appId: "1:502451588704:web:56bd4d7fc98814cddfbd05"
});
const db = firebase.database();

/* User */
let user = localStorage.getItem("user") || prompt("Your name?");
localStorage.setItem("user", user);

/* Admin */
adminBtn.onclick = () => {
  if(prompt("Admin password") === "CPE2026"){
    adminPanel.style.display="block";
  }
};

/* Teams */
function setTeams(){
  db.ref("match/teams").once("value", s=>{
    if(s.exists()) return alert("Teams already set. Use RESET MATCH.");
    db.ref("match/teams").set({
      home:{name:homeTeamName.value,logo:homeTeamLogo.value,score:0,scorers:[]},
      away:{name:awayTeamName.value,logo:awayTeamLogo.value,score:0,scorers:[]}
    });
  });
}

/* Stage */
function updateStage(){
  const st = stage.value;
  if(st==="pre"){
    const d = prompt("Match day?");
    const t = prompt("Match time?");
    db.ref("match/stage").set({stage:"pre",info:d+" • "+t});
  }
  else db.ref("match/stage").set({stage:st});
}

/* Goal */
function addGoal(side){
  const name = prompt("Scorer?");
  const time = prompt("Minute scored?");
  db.ref("match/teams/"+side).transaction(team=>{
    if(team){
      team.score = (team.score||0)+1;
      if(!team.scorers) team.scorers=[];
      team.scorers.push(name+" "+time+"'");
    }
    return team;
  });
}

/* Reset */
function resetMatch(){if(confirm("Reset match?")) db.ref("match").remove();}
function resetChat(){if(confirm("Reset chat?")) db.ref("chat").remove();}

/* Read match */
db.ref("match").on("value", s=>{
  const d = s.val()||{};
  if(d.teams){
    team1Name.textContent = d.teams.home.name;
    team2Name.textContent = d.teams.away.name;
    team1Logo.src = d.teams.home.logo;
    team2Logo.src = d.teams.away.logo;
    scoreBoard.textContent = (d.teams.home.score||0) + " : " + (d.teams.away.score||0);
    team1Scorers.textContent = (d.teams.home.scorers||[]).join(", ");
    team2Scorers.textContent = (d.teams.away.scorers||[]).join(", ");
    // Hexagon glow
    if(d.lastGoal){
      if(d.lastGoal.side==="home"){homeHex.classList.add("hexagon"); setTimeout(()=>homeHex.classList.remove("hexagon"),500);}
      if(d.lastGoal.side==="away"){awayHex.classList.add("hexagon"); setTimeout(()=>awayHex.classList.remove("hexagon"),500);}
    }
  }
  matchStatus.textContent = d.stage?.info||d.stage?.stage||"Pre-Match";
});

/* Chat */
sendBtn.onclick = ()=>{
  const msg = chatInput.value.trim();
  if(!msg) return;
  const newMsg = db.ref("chat").push();
  newMsg.set({message:msg,sender:user,timestamp:Date.now()});
  chatInput.value="";
};
chatInput.addEventListener('keypress', e=>{ if(e.key==='Enter') sendBtn.click(); });
db.ref('chat').on('value', snap=>{
  chatBox.innerHTML="";
  const data = snap.val();
  if(data) Object.keys(data).forEach(k=>{
    const m = data[k];
    const div = document.createElement("div");
    div.className="message "+(m.sender===user?'right':'left');
    div.textContent = m.message;
    div.onclick=()=>{if(m.sender===user && confirm("Delete your message?")) db.ref("chat/"+k).remove();}
    chatBox.appendChild(div);
    chatBox.scrollTop = chatBox.scrollHeight;
  });
});
</script>
</body>
</html>
