<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Department Live Match</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f5f5;
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 30px 0;
}
.scoreboard {
  width: 90%;
  max-width: 520px;
  background: #fff;
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  padding: 20px;
  position: relative;
  overflow: hidden;
}
.match-status {
  text-align: center;
  font-size: 14px;
  color: #007bff;
  margin-bottom: 12px;
  font-weight: bold;
}
.match-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  position: relative;
}
.team {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 90px;
  transition: transform 0.4s ease;
  position: relative;
  cursor: pointer;
}
.team-logo {
  width: 35px;
  height: 35px;
  object-fit: contain;
  margin-bottom: 4px;
  transition: transform 0.4s ease;
}
.team-name {
  font-weight: bold;
  font-size: 14px;
  text-align: center;
}
.score {
  font-size: 36px;
  font-weight: bold;
  text-align: center;
  width: 100px;
  transition: all 0.3s ease-in-out;
}
.score.updated {
  color: #28a745;
  text-shadow: 0 0 12px #28a745;
  transform: scale(1.5);
}
.center-line {
  position: relative;
  height: 2px;
  background: #e0e0e0;
  margin: 15px 0;
}
.center-line::before {
  content: "⚽";
  position: absolute;
  top: -10px;
  left: 50%;
  transform: translateX(-50%);
  background: #fff;
  padding: 0 6px;
}
.goal-scorers {
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  color: #555;
  margin-bottom: 12px;
}
.goal-scorers div {
  width: 90px;
  text-align: center;
}
.hex-splash, .fulltime-glow {
  position: absolute;
  width: 70px;
  height: 70px;
  top: 0;
  left: 0;
  transform: translate(-50%, -50%) scale(0);
  pointer-events: none;
  transition: transform 0.6s ease, opacity 0.6s ease;
}
#chatBox {
  border:1px solid #ccc; border-radius:8px; height:200px; overflow-y:auto; padding:10px; background:#f9f9f9;
  width: 90%; max-width: 520px; margin-top:20px;
}
#chatInput {width: calc(100% - 60px); padding:8px; border-radius:5px; border:1px solid #ccc;}
#sendBtn {width:50px; padding:8px; margin-left:5px; border-radius:5px; background:#007bff; color:#fff; border:none; cursor:pointer;}
#likeBtn {margin-top:10px; background:#ff4040; color:#fff; border:none; padding:8px 15px; border-radius:5px; cursor:pointer;}
#likeCount {margin-left:10px; font-weight:bold;}
</style>
</head>
<body>

<div class="scoreboard" id="scoreboard">

  <svg class="hex-splash" id="hexSplash" viewBox="0 0 100 100">
    <path d="M50 5 L90 25 L90 75 L50 95 L10 75 L10 25 Z" fill="rgba(0,123,255,0.3)" stroke="none"/>
  </svg>

  <svg class="fulltime-glow" id="fulltimeGlow" viewBox="0 0 100 100">
    <path d="M50 5 L90 25 L90 75 L50 95 L10 75 L10 25 Z" fill="rgba(200,200,200,0.15)" stroke="none"/>
  </svg>

  <div class="match-status" id="matchStatus">Live 60'</div>

  <div class="match-header">
    <div class="team" id="manutdTeam">
      <img class="team-logo" src="https://pngimg.com/uploads/manchester_united/manchester_united_PNG21.png" alt="Man Utd">
      <div class="team-name">Man Utd</div>
    </div>

    <div class="score" id="score">0 : 0</div>

    <div class="team" id="liverpoolTeam">
      <img class="team-logo" src="https://upload.wikimedia.org/wikipedia/en/0/0c/Liverpool_FC.svg" alt="Liverpool">
      <div class="team-name">Liverpool</div>
    </div>
  </div>

  <div class="center-line"></div>

  <div class="goal-scorers" id="goalScorers">
    <div></div>
    <div></div>
  </div>

</div>

<!-- Chat area -->
<div>
  <div id="chatBox"></div>
  <input type="text" id="chatInput" placeholder="Type a message...">
  <button id="sendBtn">Send</button>
</div>

<!-- Like button -->
<button id="likeBtn">❤️ Like</button> <span id="likeCount">0</span>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
  import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, deleteDoc, doc, increment, updateDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-firestore.js";

  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyCXEwNI2pRGt5tN_68xhTU7c5McUdz2HL8",
    authDomain: "cpe--football.firebaseapp.com",
    projectId: "cpe--football",
    storageBucket: "cpe--football.firebasestorage.app",
    messagingSenderId: "986780347918",
    appId: "1:986780347918:web:eb427cf5dd652cdae6565f"
  };
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const scoreEl = document.getElementById('score');
  const matchStatus = document.getElementById('matchStatus');
  const goalScorersEl = document.getElementById('goalScorers');
  const scoreboard = document.getElementById('scoreboard');
  const hexSplash = document.getElementById('hexSplash');
  const fulltimeGlow = document.getElementById('fulltimeGlow');
  const manutdTeam = document.getElementById('manutdTeam');
  const liverpoolTeam = document.getElementById('liverpoolTeam');

  const chatBox = document.getElementById('chatBox');
  const chatInput = document.getElementById('chatInput');
  const sendBtn = document.getElementById('sendBtn');

  const likeBtn = document.getElementById('likeBtn');
  const likeCountEl = document.getElementById('likeCount');

  let score = { manutd: 0, liverpool: 0 };
  let currentMinute = 60;
  let likes = 0;

  // Goal animation function
  function goalAnimation(teamId, scorer, minute){
    const teamEl = document.getElementById(teamId+'Team');
    score[teamId]++;
    scoreEl.textContent = `${score.manutd} : ${score.liverpool}`;
    scoreEl.classList.add('updated');

    const rect = teamEl.getBoundingClientRect();
    const boardRect = scoreboard.getBoundingClientRect();
    const left = rect.left - boardRect.left + rect.width/2;
    const top = rect.top - boardRect.top + rect.height/2;
    hexSplash.style.left = left+'px';
    hexSplash.style.top = top+'px';
    hexSplash.style.transform = 'translate(-50%, -50%) scale(2)';
    hexSplash.style.opacity = '1';

    const col = teamId==='manutd'?0:1;
    goalScorersEl.children[col].innerHTML += `${scorer} ${minute}'<br>`;

    matchStatus.textContent = `Live ${minute}'`;

    setTimeout(()=>{
      hexSplash.style.transform='translate(-50%, -50%) scale(0)';
      hexSplash.style.opacity='0';
      teamEl.style.transform='scale(1)';
      scoreEl.classList.remove('updated');
    },800);

    teamEl.style.transform='scale(1.2)';
    setTimeout(()=>teamEl.style.transform='scale(1)',800);
  }

  // Team click to add goal
  function teamClick(teamId){
    const scorer = prompt("Enter goal scorer name:");
    if(!scorer) return;
    const minuteInput = prompt(`Enter minute scored (current ${currentMinute}'):`);
    const minute = minuteInput?parseInt(minuteInput):currentMinute;
    goalAnimation(teamId,scorer,minute);
  }

  manutdTeam.addEventListener('click',()=>teamClick('manutd'));
  liverpoolTeam.addEventListener('click',()=>teamClick('liverpool'));

  // Chat functionality
  const chatCol = collection(db,'chat');
  sendBtn.addEventListener('click',async()=>{
    const msg = chatInput.value.trim();
    if(!msg) return;
    await addDoc(chatCol,{message:msg,timestamp:Date.now()});
    chatInput.value='';
  });

  const q = query(chatCol,orderBy('timestamp'));
  onSnapshot(q,snapshot=>{
    chatBox.innerHTML='';
    snapshot.forEach(docSnap=>{
      const data = docSnap.data();
      const msgEl = document.createElement('div');
      msgEl.textContent = data.message;
      msgEl.style.padding="6px";
      msgEl.style.borderBottom="1px solid #eee";
      msgEl.style.borderRadius="4px";
      msgEl.style.cursor="pointer";

      let pressTimer;
      msgEl.addEventListener('mousedown',e=>{
        pressTimer = setTimeout(()=>{
          if(confirm("Delete this message?")) deleteDoc(doc(db,'chat',docSnap.id));
        },800);
      });
      msgEl.addEventListener('mouseup',e=>clearTimeout(pressTimer));
      msgEl.addEventListener('mouseleave',e=>clearTimeout(pressTimer));

      chatBox.appendChild(msgEl);
      chatBox.scrollTop=chatBox.scrollHeight;
    });
  });

  // Like button
  likeBtn.addEventListener('click',()=>{
    likes++;
    likeCountEl.textContent=likes;
  });

</script>

</body>
</html>
