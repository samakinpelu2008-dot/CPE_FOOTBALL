<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Open Bets</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#1e1e1e;color:#fff;text-align:center;}
.container{max-width:600px;margin:30px auto;}
.card{background:#2c2c2c;padding:15px;margin-bottom:15px;border-radius:8px;text-align:left; position:relative;}
.cashout-btn{background:#4caf50;border:none;color:#fff;padding:5px 10px;border-radius:5px; cursor:pointer; float:right;}
</style>
</head>
<body>
<div class="container" id="betContainer"></div>

<script>
function updateBets(){
  const container = document.getElementById("betContainer");
  const bets = JSON.parse(localStorage.getItem("activeBets") || "[]");
  const state = JSON.parse(localStorage.getItem("matchState") || '{"home":0,"away":0,"oddsHome":2.1,"oddsDraw":3.0,"oddsAway":2.5}');
  container.innerHTML = '';
  bets.forEach((b,i)=>{
    let currentOdd = b.originalOdd;
    if(b.team==="CPE") currentOdd = state.oddsHome;
    if(b.team==="Draw") currentOdd = state.oddsDraw;
    if(b.team==="BMG") currentOdd = state.oddsAway;
    let cashout = Math.floor(b.stake * currentOdd);
    const card = document.createElement("div");
    card.className="card";
    card.innerHTML = `${b.team} | Stake: NGN ${b.stake} | Odds: ${currentOdd.toFixed(2)} <button class="cashout-btn" onclick="cashout(${i})">Cashout NGN ${cashout}</button>`;
    container.appendChild(card);
  });
}

function cashout(index){
  let bets = JSON.parse(localStorage.getItem("activeBets") || "[]");
  const b = bets[index];
  const state = JSON.parse(localStorage.getItem("matchState") || '{}');
  let currentOdd = b.originalOdd;
  if(b.team==="CPE") currentOdd = state.oddsHome;
  if(b.team==="Draw") currentOdd = state.oddsDraw;
  if(b.team==="BMG") currentOdd = state.oddsAway;
  let balance = parseInt(localStorage.getItem("balance"));
  balance += Math.floor(b.stake*currentOdd);
  localStorage.setItem("balance",balance);
  bets.splice(index,1);
  localStorage.setItem("activeBets",JSON.stringify(bets));
  updateBets();
  alert(`Cashout successful! NGN ${Math.floor(b.stake*currentOdd)}`);
}

setInterval(updateBets,1000);
</script>
</body>
</html>
