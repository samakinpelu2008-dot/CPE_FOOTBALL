<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Match Machine</title>
<style>
body { font-family: Arial,sans-serif; background:#1e1e1e; color:#fff; text-align:center; }
.container { max-width:500px; margin:30px auto; background:#2c2c2c; padding:20px; border-radius:10px; }
button { padding:10px 15px; margin:5px; border:none; border-radius:5px; cursor:pointer; }
.start-btn{background:#0a7cff;color:#fff;}
.add-goal{background:#4caf50;color:#fff;}
.stop-btn{background:#ff5722;color:#fff;}
input{padding:5px; width:80px; border-radius:5px; border:none;}
h2{margin-bottom:15px;}
</style>
</head>
<body>
<div class="container">
<h2>Admin Match Machine</h2>
<div>
  <button class="start-btn" id="startMatch">Start Match</button>
  <button class="stop-btn" id="stopMatch">End Match</button>
</div>
<div style="margin-top:15px;">
  <input type="password" id="adminPass" placeholder="Admin Password">
  <button class="add-goal" id="addGoalHome">Add Goal CPE</button>
  <button class="add-goal" id="addGoalAway">Add Goal BMG</button>
</div>
<div style="margin-top:20px;">
  <div>Time: <span id="matchTime">0'</span></div>
  <div>Score: <span id="score">0 - 0</span></div>
</div>
</div>

<script>
// --- Initial Setup ---
if(!localStorage.getItem("matchState")){
  localStorage.setItem("matchState", JSON.stringify({
    started:false,
    time:0,
    home:0,
    away:0,
    oddsHome:2.1,
    oddsDraw:3.0,
    oddsAway:2.5
  }));
}

let timerInterval = null;

function updateDisplay(){
  const state = JSON.parse(localStorage.getItem("matchState"));
  document.getElementById("matchTime").innerText = state.time + "'";
  document.getElementById("score").innerText = state.home + " - " + state.away;
}

// --- Timer ---
function startTimer(){
  if(timerInterval) clearInterval(timerInterval);
  timerInterval = setInterval(()=>{
    let state = JSON.parse(localStorage.getItem("matchState"));
    if(state.started){
      state.time += 1;
      localStorage.setItem("matchState", JSON.stringify(state));
      updateDisplay();
    }
  },2000); // 1 minute of match = 2 seconds
}

// --- Start / Stop Match ---
document.getElementById("startMatch").addEventListener("click", ()=>{
  let state = JSON.parse(localStorage.getItem("matchState"));
  state.started = true;
  localStorage.setItem("matchState", JSON.stringify(state));
  startTimer();
});

document.getElementById("stopMatch").addEventListener("click", ()=>{
  let state = JSON.parse(localStorage.getItem("matchState"));
  state.started = false;
  localStorage.setItem("matchState", JSON.stringify(state));
  clearInterval(timerInterval);
});

// --- Add Goal ---
function addGoal(team){
  const pass = document.getElementById("adminPass").value;
  if(pass !== "admin123"){ alert("Wrong password"); return; }
  let state = JSON.parse(localStorage.getItem("matchState"));
  if(team === "home") state.home += 1;
  if(team === "away") state.away += 1;

  // Adjust odds logically
  const totalGoals = state.home + state.away;
  const lead = state.home - state.away;
  state.oddsHome = Math.max(1.01, 2.1 - 0.1*lead);
  state.oddsAway = Math.max(1.01, 2.5 + 0.1*lead);
  state.oddsDraw = Math.max(1.01, 3.0 - 0.05*lead);

  localStorage.setItem("matchState", JSON.stringify(state));
  updateDisplay();
}

document.getElementById("addGoalHome").addEventListener("click", ()=>addGoal("home"));
document.getElementById("addGoalAway").addEventListener("click", ()=>addGoal("away"));

updateDisplay();
</script>
</body>
</html>
